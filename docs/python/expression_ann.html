

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>expression_ann (dCGP-ANN) &mdash; dCGP 1.5.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Symbolic Regression (UDP)" href="symbolic_regression.html" />
    <link rel="prev" title="expression_weighted (dCGP-W)" href="expression_weighted.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> dCGP
          

          
            
            <img src="../../_static/logo2.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.5.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quick start examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../cpp/index.html">C++ Documentation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Python Documentation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="index.html#utilities">Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#kernels">Kernels</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html#types-of-dcgps">Types of dCGPs</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="expression.html">expression (dCGP)</a></li>
<li class="toctree-l4"><a class="reference internal" href="expression_weighted.html">expression_weighted (dCGP-W)</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">expression_ann (dCGP-ANN)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="index.html#symbolic-regression">Symbolic Regression</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../theory/index.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">dCGP</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">API documentation</a> &raquo;</li>
        
          <li><a href="index.html">Python Documentation</a> &raquo;</li>
        
      <li>expression_ann (dCGP-ANN)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/docs/python/expression_ann.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="expression-ann-dcgp-ann">
<h1>expression_ann (dCGP-ANN)<a class="headerlink" href="#expression-ann-dcgp-ann" title="Permalink to this headline">¶</a></h1>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This Cartesian Genetic Program is able to encode an Artificial Neural Network. Weights and biases are added to the acyclic graph
as well as extra methods to allow to perform backpropagation (in parallel), to visualize the network and more …</p>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="dcgpy.expression_ann">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">dcgpy.</span></span><span class="sig-name descname"><span class="pre">expression_ann</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">inputs</span></em>, <em class="sig-param"><span class="pre">outputs</span></em>, <em class="sig-param"><span class="pre">rows</span></em>, <em class="sig-param"><span class="pre">cols</span></em>, <em class="sig-param"><span class="pre">levels_back</span></em>, <em class="sig-param"><span class="pre">arity</span> <span class="pre">=</span> <span class="pre">2</span></em>, <em class="sig-param"><span class="pre">kernels</span></em>, <em class="sig-param"><span class="pre">n_eph</span> <span class="pre">=</span> <span class="pre">0</span></em>, <em class="sig-param"><span class="pre">seed</span> <span class="pre">=</span> <span class="pre">randint</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann" title="Permalink to this definition">¶</a></dt>
<dd><p>A dCGPANN expression</p>
<p>Constructs a CGP expression operating on double</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – number of inputs</p></li>
<li><p><strong>outputs</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – number of outputs</p></li>
<li><p><strong>rows</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – number of rows of the cartesian representation of the expression as an acyclic graph.</p></li>
<li><p><strong>cols</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – number of columns of the cartesian representation of the expression as an acyclic graph.</p></li>
<li><p><strong>levels_back</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – number of levels-back allowed. This, essentially, controls the minimum number of allowed
operations in the formula. If uncertain set it to cols + 1</p></li>
<li><p><strong>arity</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code> on <code class="docutils literal notranslate"><span class="pre">list</span></code>) – arity of the kernels. Assumed equal for all columns unless its specified by a list. The list must contain a number of entries equal to the number of columns.</p></li>
<li><p><strong>kernels</strong> (<code class="docutils literal notranslate"><span class="pre">List[dcgpy.kernel_double]</span></code>) – kernel functions</p></li>
<li><p><strong>n_eph</strong> (<em>int</em>) – Number of ephemeral constants. Their values and their symbols can be set via dedicated methods.</p></li>
<li><p><strong>seed</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – random seed to generate mutations and chromosomes</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dcgpy.expression_ann.eph_val">
<span class="sig-name descname"><span class="pre">eph_val</span></span><a class="headerlink" href="#dcgpy.expression_ann.eph_val" title="Permalink to this definition">¶</a></dt>
<dd><p>Values of the ephemeral constants.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list(<code class="docutils literal notranslate"><span class="pre">`)double`</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dcgpy.expression_ann.eph_symb">
<span class="sig-name descname"><span class="pre">eph_symb</span></span><a class="headerlink" href="#dcgpy.expression_ann.eph_symb" title="Permalink to this definition">¶</a></dt>
<dd><p>Symbols used for the ephemeral constants.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list(<code class="docutils literal notranslate"><span class="pre">str</span></code>)</p>
</dd>
</dl>
</dd></dl>

<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dcgpy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dcgp</span> <span class="o">=</span> <span class="n">expression_double</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">kernel_set</span><span class="p">([</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span><span class="s2">&quot;diff&quot;</span><span class="p">,</span><span class="s2">&quot;mul&quot;</span><span class="p">,</span><span class="s2">&quot;div&quot;</span><span class="p">])(),</span> <span class="mi">0</span><span class="n">u</span><span class="p">,</span> <span class="mi">32</span><span class="n">u</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dcgp</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_out</span> <span class="o">=</span> <span class="n">dcgp</span><span class="p">([</span><span class="ow">in</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sym_out</span> <span class="o">=</span> <span class="n">dcgp</span><span class="p">([</span><span class="s2">&quot;x&quot;</span><span class="p">])</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dcgpy.expression_ann.get_bias">
<span class="sig-name descname"><span class="pre">get_bias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann.get_bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets a bias.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Convention adopted for node numbering: <a class="reference external" href="http://ppsn2014.ijs.si/files/slides/ppsn2014-tutorial3-miller.pdf">http://ppsn2014.ijs.si/files/slides/ppsn2014-tutorial3-miller.pdf</a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node_id</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – the id of the node</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The value of the bias (a <code class="docutils literal notranslate"><span class="pre">float</span></code>)</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – if <em>node_id</em> is not valid</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dcgpy.expression_ann.get_biases">
<span class="sig-name descname"><span class="pre">get_biases</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann.get_biases" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets all biases</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dcgpy.expression_ann.get_weight">
<span class="sig-name descname"><span class="pre">get_weight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann.get_weight" title="Permalink to this definition">¶</a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_weight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span></dt>
<dd><p>Gets a weight. Two overloads are available. You can get the weight specifying the node and the input id (that needs
to be less than the arity), or directly specifying its position in the weight vector.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Convention adopted for node numbering: <a class="reference external" href="http://ppsn2014.ijs.si/files/slides/ppsn2014-tutorial3-miller.pdf">http://ppsn2014.ijs.si/files/slides/ppsn2014-tutorial3-miller.pdf</a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node_id</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – the id of the node</p></li>
<li><p><strong>input_id</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – the id of the node input (0 for the first one up to arity-1)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The value of the weight (<code class="docutils literal notranslate"><span class="pre">float</span></code>)</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – if <em>node_id</em> or <em>input_id</em> or <em>idx</em> are not valid</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dcgpy.expression_ann.get_weights">
<span class="sig-name descname"><span class="pre">get_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann.get_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets all  weights</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dcgpy.expression_ann.n_active_weights">
<span class="sig-name descname"><span class="pre">n_active_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unique</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann.n_active_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the number of weights influencing the result. This will also be the number
of weights that are updated when calling sgd. The number of active weights, as well as
the number of active nodes, define the complexity of the expression expressed by the chromosome.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>unique</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) – when True weights are counted only once if connecting the same two nodes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dcgpy.expression_ann.randomise_biases">
<span class="sig-name descname"><span class="pre">randomise_biases</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">randomint</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann.randomise_biases" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomises all the values for the biases using a normal distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) – the mean of the normal distribution.</p></li>
<li><p><strong>std</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) – the standard deviation of the normal distribution.</p></li>
<li><p><strong>seed</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – the random seed to use.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dcgpy.expression_ann.randomise_weights">
<span class="sig-name descname"><span class="pre">randomise_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">randomint</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann.randomise_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomises all the values for the weights using a normal distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) – the mean of the normal distribution.</p></li>
<li><p><strong>std</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) – the standard deviation of the normal distribution.</p></li>
<li><p><strong>seed</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – the random seed to use.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dcgpy.expression_ann.set_bias">
<span class="sig-name descname"><span class="pre">set_bias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann.set_bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets a bias.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Convention adopted for node numbering: <a class="reference external" href="http://ppsn2014.ijs.si/files/slides/ppsn2014-tutorial3-miller.pdf">http://ppsn2014.ijs.si/files/slides/ppsn2014-tutorial3-miller.pdf</a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node_id</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – the id of the node whose weight is being set</p></li>
<li><p><strong>weight</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) – the new value of the weight</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if <em>node_id</em> is not valid</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dcgpy.expression_ann.set_biases">
<span class="sig-name descname"><span class="pre">set_biases</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">biases</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann.set_biases" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets all biases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>biases</strong> (<code class="docutils literal notranslate"><span class="pre">List[float]</span></code>) – the new values of the biases</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if the input vector dimension is not valid (r*c)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dcgpy.expression_ann.set_output_f">
<span class="sig-name descname"><span class="pre">set_output_f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann.set_output_f" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the nonlinearities of all nodes connected to the output nodes.
This is useful when, for example, the dCGPANN is used for a regression task where output values are expected in [-1 1]
and hence the output layer should have some sigmoid or tanh nonlinearity, or in a classification task when one wants to have a softmax
layer by having a sum in all output neurons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<code class="docutils literal notranslate"><span class="pre">string</span></code>) – the kernel name</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if <em>name</em> is not one of the kernels in the expression.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dcgpy.expression_ann.set_weight">
<span class="sig-name descname"><span class="pre">set_weight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann.set_weight" title="Permalink to this definition">¶</a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">set_weight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span></dt>
<dd><p>Sets a weight. Two overloads are available. You can set the weight specifying the node and the input id (that needs
to be less than the arity), or directly specifying its position in the weight vector.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Convention adopted for node numbering: <a class="reference external" href="http://ppsn2014.ijs.si/files/slides/ppsn2014-tutorial3-miller.pdf">http://ppsn2014.ijs.si/files/slides/ppsn2014-tutorial3-miller.pdf</a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node_id</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – the id of the node whose weight is being set</p></li>
<li><p><strong>input_id</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – the id of the node input (0 for the first one up to arity-1)</p></li>
<li><p><strong>weight</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) – the new value of the weight</p></li>
<li><p><strong>idx</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – the idx of weight to be set</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if <em>node_id</em> or <em>input_id</em> or <em>idx</em> are not valid</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dcgpy.expression_ann.set_weights">
<span class="sig-name descname"><span class="pre">set_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann.set_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets all weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>weights</strong> (<code class="docutils literal notranslate"><span class="pre">List[float]</span></code>) – the new values of the weights</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if the input vector dimension is not valid (r*c*arity)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dcgpy.expression_ann.sgd">
<span class="sig-name descname"><span class="pre">sgd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann.sgd" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs one epoch of mini-batch (stochastic) gradient descent updating the weights and biases using the
<em>points</em> and <em>labels</em> to decrease the loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (2D NumPy float array or <code class="docutils literal notranslate"><span class="pre">list</span> <span class="pre">of</span> <span class="pre">lists</span></code> of <code class="docutils literal notranslate"><span class="pre">float</span></code>) – the input data</p></li>
<li><p><strong>labels</strong> (2D NumPy float array or <code class="docutils literal notranslate"><span class="pre">list</span> <span class="pre">of</span> <span class="pre">lists</span></code> of <code class="docutils literal notranslate"><span class="pre">float</span></code>) – the output labels (supervised signal)</p></li>
<li><p><strong>lr</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) – the learning generate</p></li>
<li><p><strong>batch_size</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – the batch size</p></li>
<li><p><strong>loss_type</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) – the loss, one of “MSE” for Mean Square Error and “CE” for Cross-Entropy.</p></li>
<li><p><strong>parallel</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – sets the grain for parallelism. 0 -&gt; no parallelism n -&gt; divides the data into n parts and processes them in parallel threads</p></li>
<li><p><strong>shuffle</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) – when True it shuffles the points and labels before performing one epoch of training.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>this is only a proxy for the real loss on the whole data set.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>The average error across the batches (<code class="docutils literal notranslate"><span class="pre">float</span></code>). Note</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if <em>points</em> or <em>labels</em> are malformed or if <em>loss_type</em> is not one of the available types.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dcgpy.expression_ann.visualize">
<span class="sig-name descname"><span class="pre">visualize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show_connections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'w'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_nonlinearities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_connection_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inactive_connection_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann.visualize" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualizes the dCGPANN expression</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>show_connections</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) – shows active connections between nodes</p></li>
<li><p><strong>show_inactive</strong> (<code class="docutils literal notranslate"><span class="pre">`bool`</span></code>) – shows also inactive connections between nodes</p></li>
<li><p><strong>active_connection_alpha</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) – the alpha used to show active connections</p></li>
<li><p><strong>inactive_connection_alpha</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) – the alpha used to show inactive connections</p></li>
<li><p><strong>fill_color</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code> or <code class="docutils literal notranslate"><span class="pre">`RGB</span> <span class="pre">values`</span></code>) – the fill color of all nodes</p></li>
<li><p><strong>show_nonlinearities</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) – color codes the nodes with the contained nonlinearity</p></li>
<li><p><strong>legend</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) – shows a legend (only when show_nonlinearities is also True)</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dcgpy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nonlinearities</span> <span class="o">=</span> <span class="n">dcgpy</span><span class="o">.</span><span class="n">kernel_set_double</span><span class="p">([</span><span class="s2">&quot;sig&quot;</span><span class="p">,</span> <span class="s2">&quot;ReLu&quot;</span><span class="p">,</span> <span class="s2">&quot;tanh&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dcgpann</span> <span class="o">=</span> <span class="n">dcgpy</span><span class="o">.</span><span class="n">expression_ann</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">levels_back</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">arity</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">kernels</span><span class="o">=</span><span class="n">nonlinearities</span><span class="p">(),</span> <span class="n">seed</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dcgpann</span><span class="o">.</span><span class="n">randomise_weights</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dcgpann</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">show_nonlinearities</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="symbolic_regression.html" class="btn btn-neutral float-right" title="Symbolic Regression (UDP)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="expression_weighted.html" class="btn btn-neutral float-left" title="expression_weighted (dCGP-W)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Dario Izzo, Francesco Biscani.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>