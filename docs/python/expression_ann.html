
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>expression_ann (dCGP-ANN) &#8212; dCGP documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="C++ examples" href="../../tutorials/index.html" />
    <link rel="prev" title="expression_weighted (dCGP-W)" href="expression_weighted.html" />
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto|Comfortaa|Space+Mono">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          dcgp</a>
        <span class="navbar-text navbar-version pull-left"><b>1.3</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../installation.html">Install</a></li>
                <li><a href="../../quickstart.html">Quick Start</a></li>
                <li><a href="../index.html">Docs</a></li>
                <li><a href="../../tutorials/index.html">Tutorials</a></li>
                <li><a href="../../theory.html">Theory</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#c">C++</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#python">Python</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quick start examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart.html#c">C++</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart.html#python">Python</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../cpp/index.html">C++ Documentation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Python Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">C++ examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/index.html#symbolic-regression">Symbolic Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/index.html#other-applications">Other Applications</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html#python-examples">Python examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/learning_constants.html">Learning constants in a symbolic regression task</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/learning_constants2.html">Learning constants in a symbolic regression task (PART II)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/solving_odes.html">Solving differential equations with dCGP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/weighted_symbolic_regression.html">Weighted dCGP for a symbolic regression task</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/finding_prime_integrals.html">Discovery of prime integrals with dCGP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/An_intro_to_dCGPANNs.html">Representing an Artificial Neural Network as a Cartesian Genetic Program</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/dCGPANNs_for_classification.html">Training a FFNN in dCGPANN vs.&nbsp;Keras (classification)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/dCGPANNs_for_function_approximation.html">Training a FFNN in dCGPANN vs.&nbsp;Keras (regression)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../theory.html">Cartesian Genetic Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../theory.html#dcgp">dCGP</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../theory.html#reference">Reference</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="expression-ann-dcgp-ann">
<h1>expression_ann (dCGP-ANN)<a class="headerlink" href="#expression-ann-dcgp-ann" title="Permalink to this headline">¶</a></h1>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">This Cartesian Genetic Program is able to encode an Artificial Neural Network. Weights and biases are added to the acyclic graph
as well as extra methods to allow to perform backpropagation (in parallel), to visualize the network and more …</p>
</div>
<dl class="class">
<dt id="dcgpy.expression_ann_double">
<em class="property">class </em><code class="descclassname">dcgpy.</code><code class="descname">expression_ann_double</code><span class="sig-paren">(</span><em>inputs</em>, <em>outputs</em>, <em>rows</em>, <em>columns</em>, <em>levels_back</em>, <em>arity</em>, <em>kernels</em>, <em>n_eph</em>, <em>seed = randint</em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann_double" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs a CGP expression operating on double</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>inputs</strong> (<code class="docutils literal"><span class="pre">int</span></code>) – number of inputs</li>
<li><strong>outputs</strong> (<code class="docutils literal"><span class="pre">int</span></code>) – number of outputs</li>
<li><strong>rows</strong> (<code class="docutils literal"><span class="pre">int</span></code>) – number of rows in the cartesian program</li>
<li><strong>columns</strong> (<code class="docutils literal"><span class="pre">int</span></code>) – number of columns in the cartesian program</li>
<li><strong>levels_back</strong> (<code class="docutils literal"><span class="pre">int</span></code>) – number of levels-back in the cartesian program</li>
<li><strong>arity</strong> (<code class="docutils literal"><span class="pre">int</span></code> on <code class="docutils literal"><span class="pre">list</span></code>) – arity of the kernels. Assumed equal for all columns unless its specified by a list. The list must contain a number of entries equal to the number of columns.</li>
<li><strong>kernels</strong> (<code class="docutils literal"><span class="pre">List[dcgpy.kernel_double]</span></code>) – kernel functions</li>
<li><strong>n_eph</strong> (<em>int</em>) – Number of ephemeral constants. Their values and their symbols can be set via dedicated methods.</li>
<li><strong>seed</strong> (<code class="docutils literal"><span class="pre">int</span></code>) – random seed to generate mutations and chromosomes</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="dcgpy.expression_ann_double.eph_val">
<code class="descname">eph_val</code><a class="headerlink" href="#dcgpy.expression_ann_double.eph_val" title="Permalink to this definition">¶</a></dt>
<dd><p>Values of the ephemeral constants.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">list(<code class="docutils literal"><span class="pre">`)double`</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="dcgpy.expression_ann_double.eph_symb">
<code class="descname">eph_symb</code><a class="headerlink" href="#dcgpy.expression_ann_double.eph_symb" title="Permalink to this definition">¶</a></dt>
<dd><p>Symbols used for the ephemeral constants.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">list(<code class="docutils literal"><span class="pre">str</span></code>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dcgpy</span> <span class="k">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dcgp</span> <span class="o">=</span> <span class="n">expression_double</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">kernel_set</span><span class="p">([</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span><span class="s2">&quot;diff&quot;</span><span class="p">,</span><span class="s2">&quot;mul&quot;</span><span class="p">,</span><span class="s2">&quot;div&quot;</span><span class="p">])(),</span> <span class="mi">0</span><span class="n">u</span><span class="p">,</span> <span class="mi">32</span><span class="n">u</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dcgp</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_out</span> <span class="o">=</span> <span class="n">dcgp</span><span class="p">([</span><span class="ow">in</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sym_out</span> <span class="o">=</span> <span class="n">dcgp</span><span class="p">([</span><span class="s2">&quot;x&quot;</span><span class="p">])</span>
</pre></div>
</div>
<dl class="method">
<dt id="dcgpy.expression_ann_double.get_bias">
<code class="descname">get_bias</code><span class="sig-paren">(</span><em>node_id</em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann_double.get_bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets a bias.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Convention adopted for node numbering: <a class="reference external" href="http://ppsn2014.ijs.si/files/slides/ppsn2014-tutorial3-miller.pdf">http://ppsn2014.ijs.si/files/slides/ppsn2014-tutorial3-miller.pdf</a></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>node_id</strong> (<code class="docutils literal"><span class="pre">int</span></code>) – the id of the node</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The value of the bias (a <code class="docutils literal"><span class="pre">float</span></code>)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><strong>ValueError</strong> – if <em>node_id</em> is not valid</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dcgpy.expression_ann_double.get_biases">
<code class="descname">get_biases</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann_double.get_biases" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets all biases</p>
</dd></dl>

<dl class="method">
<dt id="dcgpy.expression_ann_double.get_weight">
<code class="descname">get_weight</code><span class="sig-paren">(</span><em>node_id</em>, <em>input_id</em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann_double.get_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>get_weight(idx)</p>
<p>Gets a weight. Two overloads are available. You can get the weight specifying the node and the input id (that needs
to be less than the arity), or directly specifying its position in the weight vector.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Convention adopted for node numbering: <a class="reference external" href="http://ppsn2014.ijs.si/files/slides/ppsn2014-tutorial3-miller.pdf">http://ppsn2014.ijs.si/files/slides/ppsn2014-tutorial3-miller.pdf</a></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>node_id</strong> (<code class="docutils literal"><span class="pre">int</span></code>) – the id of the node</li>
<li><strong>input_id</strong> (<code class="docutils literal"><span class="pre">int</span></code>) – the id of the node input (0 for the first one up to arity-1)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The value of the weight (<code class="docutils literal"><span class="pre">float</span></code>)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>ValueError</strong> – if <em>node_id</em> or <em>input_id</em> or <em>idx</em> are not valid</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dcgpy.expression_ann_double.get_weights">
<code class="descname">get_weights</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann_double.get_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets all weights</p>
</dd></dl>

<dl class="method">
<dt id="dcgpy.expression_ann_double.n_active_weights">
<code class="descname">n_active_weights</code><span class="sig-paren">(</span><em>unique = False</em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann_double.n_active_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the number of weights influencing the result. This will also be the number
of weights that are updated when calling sgd. The number of active weights, as well as
the number of active nodes, define the complexity of the expression expressed by the chromosome.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>unique</strong> (<code class="docutils literal"><span class="pre">bool</span></code>) – when True weights are counted only once if connecting the same two nodes.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dcgpy.expression_ann_double.randomise_biases">
<code class="descname">randomise_biases</code><span class="sig-paren">(</span><em>mean = 0</em>, <em>std = 0.1</em>, <em>seed = randomint</em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann_double.randomise_biases" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomises all the values for the biases using a normal distribution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mean</strong> (<code class="docutils literal"><span class="pre">float</span></code>) – the mean of the normal distribution.</li>
<li><strong>std</strong> (<code class="docutils literal"><span class="pre">float</span></code>) – the standard deviation of the normal distribution.</li>
<li><strong>seed</strong> (<code class="docutils literal"><span class="pre">int</span></code>) – the random seed to use.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dcgpy.expression_ann_double.randomise_weights">
<code class="descname">randomise_weights</code><span class="sig-paren">(</span><em>mean = 0</em>, <em>std = 0.1</em>, <em>seed = randomint</em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann_double.randomise_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomises all the values for the weights using a normal distribution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mean</strong> (<code class="docutils literal"><span class="pre">float</span></code>) – the mean of the normal distribution.</li>
<li><strong>std</strong> (<code class="docutils literal"><span class="pre">float</span></code>) – the standard deviation of the normal distribution.</li>
<li><strong>seed</strong> (<code class="docutils literal"><span class="pre">int</span></code>) – the random seed to use.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dcgpy.expression_ann_double.set_bias">
<code class="descname">set_bias</code><span class="sig-paren">(</span><em>node_id</em>, <em>bias</em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann_double.set_bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets a bias.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Convention adopted for node numbering: <a class="reference external" href="http://ppsn2014.ijs.si/files/slides/ppsn2014-tutorial3-miller.pdf">http://ppsn2014.ijs.si/files/slides/ppsn2014-tutorial3-miller.pdf</a></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>node_id</strong> (<code class="docutils literal"><span class="pre">int</span></code>) – the id of the node whose weight is being set</li>
<li><strong>weight</strong> (<code class="docutils literal"><span class="pre">float</span></code>) – the new value of the weight</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>ValueError</strong> – if <em>node_id</em> is not valid</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dcgpy.expression_ann_double.set_biases">
<code class="descname">set_biases</code><span class="sig-paren">(</span><em>biases</em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann_double.set_biases" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets all biases.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>biases</strong> (<code class="docutils literal"><span class="pre">List[float]</span></code>) – the new values of the biases</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><strong>ValueError</strong> – if the input vector dimension is not valid (r*c)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dcgpy.expression_ann_double.set_output_f">
<code class="descname">set_output_f</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann_double.set_output_f" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the nonlinearities of all nodes connected to the output nodes.
This is useful when, for example, the dCGPANN is used for a regression task where output values are expected in [-1 1]
and hence the output layer should have some sigmoid or tanh nonlinearity, or in a classification task when one wants to have a softmax
layer by having a sum in all output neurons.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<code class="docutils literal"><span class="pre">string</span></code>) – the kernel name</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><strong>ValueError</strong> – if <em>name</em> is not one of the kernels in the expression.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dcgpy.expression_ann_double.set_weight">
<code class="descname">set_weight</code><span class="sig-paren">(</span><em>node_id</em>, <em>input_id</em>, <em>weight</em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann_double.set_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>set_weight(idx, weight)</p>
<p>Sets a weight. Two overloads are available. You can set the weight specifying the node and the input id (that needs
to be less than the arity), or directly specifying its position in the weight vector.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Convention adopted for node numbering: <a class="reference external" href="http://ppsn2014.ijs.si/files/slides/ppsn2014-tutorial3-miller.pdf">http://ppsn2014.ijs.si/files/slides/ppsn2014-tutorial3-miller.pdf</a></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>node_id</strong> (<code class="docutils literal"><span class="pre">int</span></code>) – the id of the node whose weight is being set</li>
<li><strong>input_id</strong> (<code class="docutils literal"><span class="pre">int</span></code>) – the id of the node input (0 for the first one up to arity-1)</li>
<li><strong>weight</strong> (<code class="docutils literal"><span class="pre">float</span></code>) – the new value of the weight</li>
<li><strong>idx</strong> (<code class="docutils literal"><span class="pre">int</span></code>) – the idx of weight to be set</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>ValueError</strong> – if <em>node_id</em> or <em>input_id</em> or <em>idx</em> are not valid</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dcgpy.expression_ann_double.set_weights">
<code class="descname">set_weights</code><span class="sig-paren">(</span><em>weights</em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann_double.set_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets all weights.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>weights</strong> (<code class="docutils literal"><span class="pre">List[float]</span></code>) – the new values of the weights</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><strong>ValueError</strong> – if the input vector dimension is not valid (r*c*arity)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dcgpy.expression_ann_double.sgd">
<code class="descname">sgd</code><span class="sig-paren">(</span><em>points</em>, <em>labels</em>, <em>lr</em>, <em>batch_size</em>, <em>loss_type</em>, <em>parallel = 0</em>, <em>shuffle = True</em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann_double.sgd" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs one epoch of mini-batch (stochastic) gradient descent updating the weights and biases using the
<em>points</em> and <em>labels</em> to decrease the loss.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>points</strong> (2D NumPy float array or <code class="docutils literal"><span class="pre">list</span> <span class="pre">of</span> <span class="pre">lists</span></code> of <code class="docutils literal"><span class="pre">float</span></code>) – the input data</li>
<li><strong>labels</strong> (2D NumPy float array or <code class="docutils literal"><span class="pre">list</span> <span class="pre">of</span> <span class="pre">lists</span></code> of <code class="docutils literal"><span class="pre">float</span></code>) – the output labels (supervised signal)</li>
<li><strong>lr</strong> (<code class="docutils literal"><span class="pre">float</span></code>) – the learning generate</li>
<li><strong>batch_size</strong> (<code class="docutils literal"><span class="pre">int</span></code>) – the batch size</li>
<li><strong>loss_type</strong> (<code class="docutils literal"><span class="pre">str</span></code>) – the loss, one of “MSE” for Mean Square Error and “CE” for Cross-Entropy.</li>
<li><strong>parallel</strong> (<code class="docutils literal"><span class="pre">int</span></code>) – sets the grain for parallelism. 0 -&gt; no parallelism n -&gt; divides the data into n parts and processes them in parallel threads</li>
<li><strong>shuffle</strong> (<code class="docutils literal"><span class="pre">bool</span></code>) – when True it shuffles the points and labels before performing one epoch of training.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">this is only a proxy for the real loss on the whole data set.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">The average error across the batches (<code class="docutils literal"><span class="pre">float</span></code>). Note</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>ValueError</strong> – if <em>points</em> or <em>labels</em> are malformed or if <em>loss_type</em> is not one of the available types.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dcgpy.expression_ann_double.visualize">
<code class="descname">visualize</code><span class="sig-paren">(</span><em>show_connections = True</em>, <em>fill_color = 'w'</em>, <em>show_nonlinearities = False</em>, <em>active_connection_alpha = 0.1</em>, <em>inactive_connection_alpha = 0.01</em>, <em>legend = True</em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.expression_ann_double.visualize" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualizes the dCGPANN expression</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>show_connections</strong> (<code class="docutils literal"><span class="pre">bool</span></code>) – shows active connections between nodes</li>
<li><strong>show_inactive</strong> (<code class="docutils literal"><span class="pre">`bool`</span></code>) – shows also inactive connections between nodes</li>
<li><strong>active_connection_alpha</strong> (<code class="docutils literal"><span class="pre">bool</span></code>) – the alpha used to show active connections</li>
<li><strong>inactive_connection_alpha</strong> (<code class="docutils literal"><span class="pre">bool</span></code>) – the alpha used to show inactive connections</li>
<li><strong>fill_color</strong> (<code class="docutils literal"><span class="pre">str</span></code> or <code class="docutils literal"><span class="pre">`RGB</span> <span class="pre">values`</span></code>) – the fill color of all nodes</li>
<li><strong>show_nonlinearities</strong> (<code class="docutils literal"><span class="pre">bool</span></code>) – color codes the nodes with the contained nonlinearity</li>
<li><strong>legend</strong> (<code class="docutils literal"><span class="pre">bool</span></code>) – shows a legend (only when show_nonlinearities is also True)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dcgpy</span> <span class="k">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nonlinearities</span> <span class="o">=</span> <span class="n">dcgpy</span><span class="o">.</span><span class="n">kernel_set_double</span><span class="p">([</span><span class="s2">&quot;sig&quot;</span><span class="p">,</span> <span class="s2">&quot;ReLu&quot;</span><span class="p">,</span> <span class="s2">&quot;tanh&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dcgpann</span> <span class="o">=</span> <span class="n">dcgpy</span><span class="o">.</span><span class="n">expression_ann_double</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">levels_back</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">arity</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">kernels</span><span class="o">=</span><span class="n">nonlinearities</span><span class="p">(),</span> <span class="n">seed</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dcgpann</span><span class="o">.</span><span class="n">randomise_weights</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dcgpann</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">show_nonlinearities</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018, Dario Izzo, Francesco Biscani, Alessio Mereta.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.7.<br/>
    </p>
  </div>
</footer>
  </body>
</html>