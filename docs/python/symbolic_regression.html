

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Symbolic Regression (UDP) &mdash; dCGP 1.5.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Evolutionary Strategy (UDA)" href="es4cgp.html" />
    <link rel="prev" title="expression_ann (dCGP-ANN)" href="expression_ann.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> dCGP
          

          
            
            <img src="../../_static/logo2.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.5.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quick start examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../cpp/index.html">C++ Documentation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Python Documentation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="index.html#kernels">Kernels</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#types-of-dcgps">Types of dCGPs</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html#symbolic-regression">Symbolic Regression</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Symbolic Regression (UDP)</a></li>
<li class="toctree-l4"><a class="reference internal" href="es4cgp.html">Evolutionary Strategy (UDA)</a></li>
<li class="toctree-l4"><a class="reference internal" href="gd4cgp.html">Gradient Descent (UDA)</a></li>
<li class="toctree-l4"><a class="reference internal" href="mes4cgp.html">Memetic Evolutionary Strategy (UDA)</a></li>
<li class="toctree-l4"><a class="reference internal" href="momes4cgp.html">Multi-Objective Memetic Evolutionary Strategy (UDA)</a></li>
<li class="toctree-l4"><a class="reference internal" href="koza_quintic.html">Koza Quintic</a></li>
<li class="toctree-l4"><a class="reference internal" href="p_problems.html">Problems P1-P7</a></li>
<li class="toctree-l4"><a class="reference internal" href="vladislavleva_problems.html">Problems from Vladislavleva</a></li>
<li class="toctree-l4"><a class="reference internal" href="nist_problems.html">NIST problems (StRD)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../theory/index.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">dCGP</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">API documentation</a> &raquo;</li>
        
          <li><a href="index.html">Python Documentation</a> &raquo;</li>
        
      <li>Symbolic Regression (UDP)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/docs/python/symbolic_regression.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="symbolic-regression-udp">
<h1>Symbolic Regression (UDP)<a class="headerlink" href="#symbolic-regression-udp" title="Permalink to this headline">¶</a></h1>
<div class="figure align-default">
<img alt="weighted dCGP expression" src="../../_images/symbolic_regression1.jpg" />
</div>
<dl class="py class">
<dt class="sig sig-object py" id="dcgpy.symbolic_regression">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">dcgpy.</span></span><span class="sig-name descname"><span class="pre">symbolic_regression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">points</span></em>, <em class="sig-param"><span class="pre">labels</span></em>, <em class="sig-param"><span class="pre">rows</span> <span class="pre">=</span> <span class="pre">1</span></em>, <em class="sig-param"><span class="pre">columns=16</span></em>, <em class="sig-param"><span class="pre">levels_back=17</span></em>, <em class="sig-param"><span class="pre">arity=2</span></em>, <em class="sig-param"><span class="pre">kernels</span></em>, <em class="sig-param"><span class="pre">n_eph=0</span></em>, <em class="sig-param"><span class="pre">multi_objective=False</span></em>, <em class="sig-param"><span class="pre">parallel_batches=0</span></em>, <em class="sig-param"><span class="pre">loss=&quot;MSE&quot;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dcgpy.symbolic_regression" title="Permalink to this definition">¶</a></dt>
<dd><p>Symbolic regression is a type of regression analysis that searches the space of mathematical expressions to
find the model that best fits a given dataset, both in terms of accuracy and simplicity
(ref: <a class="reference external" href="https://en.wikipedia.org/wiki/Symbolic_regression">https://en.wikipedia.org/wiki/Symbolic_regression</a>). It also is one of the applications
for Differentiable Cartesian Genetic Programming.</p>
<p>This class provides an easy way to instantiate symbolic regression problems as optimization problems having
a continuous part (i.e. the value of the parameters in the model) and an integer part (i.e. the representation of
the model computational graph). The instantiated object can be used as UDP (User Defined Problem) in the pygmo optimization suite.</p>
<p>The symbolic regression problem can be instantiated both as a single and as a two-objectives problem. In the second
case, aside the chosen loss on the data, the model complexity will be considered as an objective.</p>
<p>Constructs a symbolic_regression optimization problem compatible with the pagmo UDP interface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (2D NumPy float array or <code class="docutils literal notranslate"><span class="pre">list</span> <span class="pre">of</span> <span class="pre">lists</span></code> of <code class="docutils literal notranslate"><span class="pre">float</span></code>) – the input data</p></li>
<li><p><strong>labels</strong> (2D NumPy float array or <code class="docutils literal notranslate"><span class="pre">list</span> <span class="pre">of</span> <span class="pre">lists</span></code> of <code class="docutils literal notranslate"><span class="pre">float</span></code>) – the output data (to be predicted)</p></li>
<li><p><strong>rows</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – number of rows in the cartesian program</p></li>
<li><p><strong>columns</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – number of columns in the cartesian program</p></li>
<li><p><strong>levels_back</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – number of levels-back in the cartesian program</p></li>
<li><p><strong>arity</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code> on <code class="docutils literal notranslate"><span class="pre">list</span></code>) – arity of the kernels. Assumed equal for all columns.</p></li>
<li><p><strong>kernels</strong> (<code class="docutils literal notranslate"><span class="pre">List[dcgpy.kernel_]</span></code>) – kernel functions</p></li>
<li><p><strong>n_eph</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – Number of ephemeral constants.</p></li>
<li><p><strong>multi_objective</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>) – when True the problem will be considered as multiobjective (loss and model complexity).</p></li>
<li><p><strong>parallel_batches</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – allows to split the data into batches for parallel evaluation.</p></li>
<li><p><strong>loss</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) – loss type used, one of “MSE” (for mean squared error) or “CE” (for cross entropy).</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>unspecified</strong> – any exception thrown by failures at the intersection between C++ and Python (e.g.,
    type conversion errors, mismatched function signatures, etc.)</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dcgpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pygmo</span> <span class="k">as</span> <span class="nn">pg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">dcgpy</span><span class="o">.</span><span class="n">generate_koza_quintic</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">udp</span> <span class="o">=</span> <span class="n">dcgpy</span><span class="o">.</span><span class="n">symbolic_regression</span><span class="p">(</span>
<span class="gp">... </span>       <span class="n">points</span> <span class="o">=</span> <span class="n">X</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">labels</span> <span class="o">=</span> <span class="n">Y</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">cols</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">levels_back</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">arity</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">kernels</span> <span class="o">=</span> <span class="n">dcgpy</span><span class="o">.</span><span class="n">kernel_set_double</span><span class="p">([</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;diff&quot;</span><span class="p">])(),</span>
<span class="gp">... </span>       <span class="n">n_eph</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">multi_objective</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">parallel_batches</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prob</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">problem</span><span class="p">(</span><span class="n">udp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span> 
<span class="go">Problem name: a CGP symbolic regression problem</span>
<span class="go">    Global dimension:                       62</span>
<span class="go">    Integer dimension:                      61</span>
<span class="go">    Fitness dimension:                      2</span>
<span class="go">    Number of objectives:                   2</span>
<span class="go">    Equality constraints dimension:         0</span>
<span class="go">    Inequality constraints dimension:       0</span>
<span class="go">    Lower bounds: [-10, 0, 0, 0, 0, ... ]</span>
<span class="go">    Upper bounds: [10, 1, 1, 1, 1, ... ]</span>
<span class="go">    Has batch fitness evaluation: false</span>

<span class="go">    Has gradient: true</span>
<span class="go">    User implemented gradient sparsity: true</span>
<span class="go">    Expected gradients: 1</span>
<span class="go">    Has hessians: true</span>
<span class="go">    User implemented hessians sparsity: true</span>
<span class="go">    Expected hessian components: [1, 1]</span>

<span class="go">    Fitness evaluations: 0</span>
<span class="go">    Gradient evaluations: 0</span>
<span class="go">    Hessians evaluations: 0</span>

<span class="go">    Thread safety: basic</span>

<span class="go">Extra info:</span>
<span class="go">    Data dimension (in): 1</span>
<span class="go">    Data dimension (out): 1</span>
<span class="go">    Data size: 10</span>
<span class="go">    Kernels: [sum, diff]</span>
</pre></div>
</div>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="es4cgp.html" class="btn btn-neutral float-right" title="Evolutionary Strategy (UDA)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="expression_ann.html" class="btn btn-neutral float-left" title="expression_ann (dCGP-ANN)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Dario Izzo, Francesco Biscani.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>